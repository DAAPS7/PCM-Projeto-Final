---
title: "MusicaInator 3000"
format:
  dashboard: 
    orientation: columns
    scrolling: true
    page-layout: none
    css: assets/css/style.css
---

## Column

### Row 1 {height=75vh}

```{ojs}
//| expandable: false

html `<input type="file" id="audioFile" accept="audio/*" />`

fileChange = {

    async function requestSongAPI(file) {
        const token = 'c68dc7c96dc75ce14c48740ab7bf4b08';

        console.log("File:", file);

        const formData = new FormData();
        formData.append("api_token", token);
        formData.append("file", file);
        formData.append("return", "apple_music,spotify");
        formData.append("accurate_offsets", 'true');
        formData.append("skip", '3');
        formData.append("every", '1');

        fetch("https://api.audd.io/", {
            method: "POST",
            body: formData
        })
            .then((response) => {
                console.log(response.status);
                return response.json();
            })
            .then((response) => {
                console.log(response);
            })
            .catch((error) => {
                console.error(error);
            });
    }

    // Waits for DOM to load
    document.addEventListener('DOMContentLoaded', function() {
        const audioInput = document.getElementById('audioFile');
        audioInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                // Loaded file by user
                let audioFile = e.target.files[0];
                //requestSongAPI(audioFile);
            }
        });
    });
}

/* MODO TESTE */
resultAPI = FileAttachment("data/testFile.json").json()

resultAPI.result.artist
resultAPI.result.title
resultAPI.result.album
resultAPI.result.timecode

lyrics = {
    let query = {
        track_name: resultAPI.result.title,
        artist_name: resultAPI.result.artist
    }

    const params = new URLSearchParams(query);
    const response = await fetch(`https://lrclib.net/api/get?${params}`);
    const data = await response.json();

    return data
}

lyrics.syncedLyrics

// Ideia: Aplicação que permite o upload de ficheiros musicais e analisa a música, devolvendo a letra da música, género musical e outras propriedades da música. Também terá uma secção de análise de áudio.

```

```{ojs}
//| expandable: false

"Second Column"

```

### Row 2 {height=10vh}

```{ojs}
//| expandable: false

"Play Row"
```